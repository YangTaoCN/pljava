<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_80) on Sun Oct 07 17:02:15 EDT 2018 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>DualState (PL/Java backend Java code 1.5.1-BETA3 API)</title>
<meta name="date" content="2018-10-07">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="DualState (PL/Java backend Java code 1.5.1-BETA3 API)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/DualState.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../org/postgresql/pljava/internal/ByteBufferInputStream.html" title="class in org.postgresql.pljava.internal"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../org/postgresql/pljava/internal/DualState.Key.html" title="class in org.postgresql.pljava.internal"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?org/postgresql/pljava/internal/DualState.html" target="_top">Frames</a></li>
<li><a href="DualState.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested_class_summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.postgresql.pljava.internal</div>
<h2 title="Class DualState" class="title">Class DualState&lt;T&gt;</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li><a href="http://docs.oracle.com/javase/6/docs/api/java/lang/ref/Reference.html?is-external=true" title="class or interface in java.lang.ref">java.lang.ref.Reference</a>&lt;T&gt;</li>
<li>
<ul class="inheritance">
<li><a href="http://docs.oracle.com/javase/6/docs/api/java/lang/ref/WeakReference.html?is-external=true" title="class or interface in java.lang.ref">java.lang.ref.WeakReference</a>&lt;T&gt;</li>
<li>
<ul class="inheritance">
<li>org.postgresql.pljava.internal.DualState&lt;T&gt;</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>Direct Known Subclasses:</dt>
<dd><a href="../../../../org/postgresql/pljava/internal/DualState.SingleMemContextDelete.html" title="class in org.postgresql.pljava.internal">DualState.SingleMemContextDelete</a>, <a href="../../../../org/postgresql/pljava/internal/DualState.SinglePfree.html" title="class in org.postgresql.pljava.internal">DualState.SinglePfree</a></dd>
</dl>
<hr>
<br>
<pre>public abstract class <span class="strong">DualState&lt;T&gt;</span>
extends <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/ref/WeakReference.html?is-external=true" title="class or interface in java.lang.ref">WeakReference</a>&lt;T&gt;</pre>
<div class="block">Base class for object state with corresponding Java and native components.
<p>
 A <code>DualState</code> object connects some state that exists in the JVM
 as well as some native/PostgreSQL resources. It will 'belong' to some Java
 object that holds a strong reference to it, and this state object is,
 in turn, a <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/ref/WeakReference.html?is-external=true" title="class or interface in java.lang.ref"><code>WeakReference</code></a> to that object. Java state may be held in
 that object (if it needs only to be freed by the garbage collector when
 unreachable), or in this object if it needs some more specific cleanup.
 Native state will be referred to by this object.
<p>
 These interesting events are possible in the life cycle of a
 <code>DualState</code> object:
 <ul>
 <li>It is explicitly closed by the Java code using it. It, and any associated
 native state, should be released.</li>
 <li>It is found unreachable by the Java garbage collector. Again, any
 associated state should be released.</li>
 <li>Its associated native state is released or invalidated (such as by exit
 of a corresponding context). If the object is still reachable from Java, it
 must be marked to throw an exception for any future attempted access to its
 native state.</li>
 </ul>
<p>
 The introduction of this class represents <em>yet another</em> pattern
 within PL/Java for objects that combine Java and native state. It is meant
 to be general (and documented) enough to support future gradual migration of
 other existing patterns to it.
<p>
 A parameter to the <code>DualState</code> constructor is a <code>ResourceOwner</code>,
 a PostgreSQL implementation concept introduced in PG 8.0. Instances will be
 called at their <a href="../../../../org/postgresql/pljava/internal/DualState.html#nativeStateReleased()"><code>nativeStateReleased</code></a> methods
 when the corresponding <code>ResourceOwner</code> is released in PostgreSQL.
<p>
 Instances will be enqueued on a <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/ref/ReferenceQueue.html?is-external=true" title="class or interface in java.lang.ref"><code>ReferenceQueue</code></a> when found by the Java
 garbage collector to be unreachable. The
 <a href="../../../../org/postgresql/pljava/internal/DualState.html#cleanEnqueuedInstances()"><code>cleanEnqueuedInstances</code></a> static method will
 call those instances at their
 <a href="../../../../org/postgresql/pljava/internal/DualState.html#javaStateUnreachable()"><code>javaStateUnreachable</code></a> methods if the weak
 reference has already been cleared by the garbage collector. The method
 should clean up any lingering native state.
<p>
 As the native cleanup is likely to involve calls into PostgreSQL, to reduce
 thread contention, <code>cleanEnqueuedInstances</code> should be called in one or
 more likely places from a thread already known to be entering/exiting Java
 from/to PostgreSQL.
<p>
 If convenient, explicit close actions from Java can be handled similarly,
 by having the close method call <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/ref/Reference.html?is-external=true#enqueue()" title="class or interface in java.lang.ref"><code>enqueue</code></a>, and providing a
 <a href="../../../../org/postgresql/pljava/internal/DualState.html#javaStateReleased()"><code>javaStateReleased</code></a> method, which will be called by
 <code>cleanEnqueuedInstances</code> if the weak reference is nonnull, indicating
 the instance was enqueued explicitly rather than by the garbage collector.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested_class_summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Class and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../../org/postgresql/pljava/internal/DualState.Key.html" title="class in org.postgresql.pljava.internal">DualState.Key</a></strong></code>
<div class="block">Magic cookie needed as a constructor parameter to confirm that
 <code>DualState</code> subclass instances are being constructed from
 native code.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../../org/postgresql/pljava/internal/DualState.SingleMemContextDelete.html" title="class in org.postgresql.pljava.internal">DualState.SingleMemContextDelete</a>&lt;<a href="../../../../org/postgresql/pljava/internal/DualState.SingleMemContextDelete.html" title="type parameter in DualState.SingleMemContextDelete">T</a>&gt;</strong></code>
<div class="block">A <code>DualState</code> subclass whose only native resource releasing action
 needed is <code>MemoryContextDelete</code> of a single context.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../../org/postgresql/pljava/internal/DualState.SinglePfree.html" title="class in org.postgresql.pljava.internal">DualState.SinglePfree</a>&lt;<a href="../../../../org/postgresql/pljava/internal/DualState.SinglePfree.html" title="type parameter in DualState.SinglePfree">T</a>&gt;</strong></code>
<div class="block">A <code>DualState</code> subclass whose only native resource releasing action
 needed is <code>pfree</code> of a single pointer.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected long</code></td>
<td class="colLast"><code><strong><a href="../../../../org/postgresql/pljava/internal/DualState.html#m_resourceOwner">m_resourceOwner</a></strong></code>
<div class="block">Pointer value of the <code>ResourceOwner</code> this instance belongs to,
 if any.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier</th>
<th class="colLast" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected </code></td>
<td class="colLast"><code><strong><a href="../../../../org/postgresql/pljava/internal/DualState.html#DualState(org.postgresql.pljava.internal.DualState.Key,%20T,%20long)">DualState</a></strong>(<a href="../../../../org/postgresql/pljava/internal/DualState.Key.html" title="class in org.postgresql.pljava.internal">DualState.Key</a>&nbsp;cookie,
         <a href="../../../../org/postgresql/pljava/internal/DualState.html" title="type parameter in DualState">T</a>&nbsp;referent,
         long&nbsp;resourceOwner)</code>
<div class="block">Construct a <code>DualState</code> instance with a reference to the Java
 object whose state it represents.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/postgresql/pljava/internal/DualState.html#assertNativeStateIsValid()">assertNativeStateIsValid</a></strong>()</code>
<div class="block">Throw an <code>SQLException</code> with a default message and SQLSTATE code
 of 55000 "object not in prerequisite state" if <code>nativeStateIsValid</code>
 returns <code>false</code>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/postgresql/pljava/internal/DualState.html#assertNativeStateIsValid(java.lang.String)">assertNativeStateIsValid</a></strong>(<a href="http://docs.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;message)</code>
<div class="block">Throw an <code>SQLException</code> with a specified message and SQLSTATE code
 of 55000 "object not in prerequisite state" if <code>nativeStateIsValid</code>
 returns <code>false</code>.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/postgresql/pljava/internal/DualState.html#assertNativeStateIsValid(java.lang.String,%20java.lang.String)">assertNativeStateIsValid</a></strong>(<a href="http://docs.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;message,
                        <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;sqlState)</code>
<div class="block">Throw an <code>SQLException</code> with a specified message and SQLSTATE code
 if <code>nativeStateIsValid</code> returns <code>false</code>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected static void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/postgresql/pljava/internal/DualState.html#checkCookie(org.postgresql.pljava.internal.DualState.Key)">checkCookie</a></strong>(<a href="../../../../org/postgresql/pljava/internal/DualState.Key.html" title="class in org.postgresql.pljava.internal">DualState.Key</a>&nbsp;cookie)</code>
<div class="block">Check that a cookie is valid, throwing an unchecked exception otherwise.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/postgresql/pljava/internal/DualState.html#javaStateReleased()">javaStateReleased</a></strong>()</code>
<div class="block">Method that can be called to indicate that Java code has explicitly
 released the instance (for example, through calling a <code>close</code>
 method on the referent object).</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/postgresql/pljava/internal/DualState.html#javaStateUnreachable()">javaStateUnreachable</a></strong>()</code>
<div class="block">Method that will be called when the Java garbage collector has determined
 the referent object is no longer strongly reachable.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected abstract boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../org/postgresql/pljava/internal/DualState.html#nativeStateIsValid()">nativeStateIsValid</a></strong>()</code>
<div class="block">Return <code>true</code> if the native state is still valid.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected abstract void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/postgresql/pljava/internal/DualState.html#nativeStateReleased()">nativeStateReleased</a></strong>()</code>
<div class="block">Method that will be called when the associated <code>ResourceOwner</code>
 is released, indicating that the native portion of the state
 is no longer valid.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="http://docs.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><strong><a href="../../../../org/postgresql/pljava/internal/DualState.html#toString()">toString</a></strong>()</code>
<div class="block">Produce a string describing this state object in a way useful for
 debugging, with such information as the associated <code>ResourceOwner</code>
 and whether the state is fresh or stale.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="http://docs.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><strong><a href="../../../../org/postgresql/pljava/internal/DualState.html#toString(java.lang.Object)">toString</a></strong>(<a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>&nbsp;o)</code>
<div class="block">Produce a string with such details of this object as might be useful for
 debugging, starting with an abbreviated form of the class name of the
 supplied object.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.ref.Reference">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.ref.<a href="http://docs.oracle.com/javase/6/docs/api/java/lang/ref/Reference.html?is-external=true" title="class or interface in java.lang.ref">Reference</a></h3>
<code><a href="http://docs.oracle.com/javase/6/docs/api/java/lang/ref/Reference.html?is-external=true#clear()" title="class or interface in java.lang.ref">clear</a>, <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/ref/Reference.html?is-external=true#enqueue()" title="class or interface in java.lang.ref">enqueue</a>, <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/ref/Reference.html?is-external=true#get()" title="class or interface in java.lang.ref">get</a>, <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/ref/Reference.html?is-external=true#isEnqueued()" title="class or interface in java.lang.ref">isEnqueued</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang">clone</a>, <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang">equals</a>, <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang">finalize</a>, <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang">getClass</a>, <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang">hashCode</a>, <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang">notify</a>, <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang">notifyAll</a>, <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#wait(long,%20int)" title="class or interface in java.lang">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="m_resourceOwner">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>m_resourceOwner</h4>
<pre>protected final&nbsp;long m_resourceOwner</pre>
<div class="block">Pointer value of the <code>ResourceOwner</code> this instance belongs to,
 if any.</div>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="DualState(org.postgresql.pljava.internal.DualState.Key,java.lang.Object,long)">
<!--   -->
</a><a name="DualState(org.postgresql.pljava.internal.DualState.Key, T, long)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>DualState</h4>
<pre>protected&nbsp;DualState(<a href="../../../../org/postgresql/pljava/internal/DualState.Key.html" title="class in org.postgresql.pljava.internal">DualState.Key</a>&nbsp;cookie,
         <a href="../../../../org/postgresql/pljava/internal/DualState.html" title="type parameter in DualState">T</a>&nbsp;referent,
         long&nbsp;resourceOwner)</pre>
<div class="block">Construct a <code>DualState</code> instance with a reference to the Java
 object whose state it represents.
<p>
 Subclass constructors must accept a <em>cookie</em> parameter from the
 native caller, and pass it along to superclass constructors. That allows
 some confidence that constructor parameters representing native values
 are for real, and also that the construction is taking place on a thread
 holding the native lock, keeping the concurrency story simple.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>cookie</code> - Capability held by native code to invoke <code>DualState</code>
 constructors.</dd><dd><code>referent</code> - The Java object whose state this instance represents.</dd><dd><code>resourceOwner</code> - Pointer value of the native <code>ResourceOwner</code>
 whose release callback will indicate that this object's native state is
 no longer valid.</dd></dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="checkCookie(org.postgresql.pljava.internal.DualState.Key)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>checkCookie</h4>
<pre>protected static&nbsp;void&nbsp;checkCookie(<a href="../../../../org/postgresql/pljava/internal/DualState.Key.html" title="class in org.postgresql.pljava.internal">DualState.Key</a>&nbsp;cookie)</pre>
<div class="block">Check that a cookie is valid, throwing an unchecked exception otherwise.</div>
</li>
</ul>
<a name="nativeStateIsValid()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>nativeStateIsValid</h4>
<pre>protected abstract&nbsp;boolean&nbsp;nativeStateIsValid()</pre>
<div class="block">Return <code>true</code> if the native state is still valid. An abstract
 method so it can be tailored to whatever native state is maintained
 by an implementing class.</div>
</li>
</ul>
<a name="nativeStateReleased()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>nativeStateReleased</h4>
<pre>protected abstract&nbsp;void&nbsp;nativeStateReleased()</pre>
<div class="block">Method that will be called when the associated <code>ResourceOwner</code>
 is released, indicating that the native portion of the state
 is no longer valid. The implementing class should clean up
 whatever is appropriate to that event, and must ensure that
 <code>nativeStateIsValid</code> will thereafter return <code>false</code>.
<p>
 This object's monitor will always be held when this method is called
 during resource owner release. The class whose state this is must
 synchronize and hold this object's monitor for the duration of any
 operation that could refer to the native state.</div>
</li>
</ul>
<a name="javaStateUnreachable()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>javaStateUnreachable</h4>
<pre>protected&nbsp;void&nbsp;javaStateUnreachable()</pre>
<div class="block">Method that will be called when the Java garbage collector has determined
 the referent object is no longer strongly reachable. This default
 implementation does nothing; a subclass should override it to do any
 cleanup, or release of native resources, that may be required.
<p>
 It is not necessary for this method to remove the instance from the
 <code>liveInstances</code> collection; that will have been done just before
 this method is called.</div>
</li>
</ul>
<a name="javaStateReleased()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>javaStateReleased</h4>
<pre>protected&nbsp;void&nbsp;javaStateReleased()</pre>
<div class="block">Method that can be called to indicate that Java code has explicitly
 released the instance (for example, through calling a <code>close</code>
 method on the referent object). This can be handled two ways:
<ul>
 <li>A <code>close</code> or similar method calls this directly. This instance
 must be removed from the <code>liveInstances</code> collection. This default
 implementation does so.
 <li>A <code>close</code> or similar method simply calls
 <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/ref/Reference.html?is-external=true#enqueue()" title="class or interface in java.lang.ref"><code>enqueue</code></a> instead of this method. This method will be
 called when the queue is processed, the next time native code calls
 <a href="../../../../org/postgresql/pljava/internal/DualState.html#cleanEnqueuedInstances()"><code>cleanEnqueuedInstances</code></a>. For that case,
 this method should be overridden to do whatever other cleanup is in
 order, but <em>not</em> remove the instance from <code>liveInstances</code>,
 which will have happened just before this method is called.
</ul></div>
</li>
</ul>
<a name="assertNativeStateIsValid(java.lang.String, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>assertNativeStateIsValid</h4>
<pre>public&nbsp;void&nbsp;assertNativeStateIsValid(<a href="http://docs.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;message,
                            <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;sqlState)
                              throws <a href="http://docs.oracle.com/javase/6/docs/api/java/sql/SQLException.html?is-external=true" title="class or interface in java.sql">SQLException</a></pre>
<div class="block">Throw an <code>SQLException</code> with a specified message and SQLSTATE code
 if <code>nativeStateIsValid</code> returns <code>false</code>.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/6/docs/api/java/sql/SQLException.html?is-external=true" title="class or interface in java.sql">SQLException</a></code></dd></dl>
</li>
</ul>
<a name="assertNativeStateIsValid(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>assertNativeStateIsValid</h4>
<pre>public&nbsp;void&nbsp;assertNativeStateIsValid(<a href="http://docs.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;message)
                              throws <a href="http://docs.oracle.com/javase/6/docs/api/java/sql/SQLException.html?is-external=true" title="class or interface in java.sql">SQLException</a></pre>
<div class="block">Throw an <code>SQLException</code> with a specified message and SQLSTATE code
 of 55000 "object not in prerequisite state" if <code>nativeStateIsValid</code>
 returns <code>false</code>.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/6/docs/api/java/sql/SQLException.html?is-external=true" title="class or interface in java.sql">SQLException</a></code></dd></dl>
</li>
</ul>
<a name="assertNativeStateIsValid()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>assertNativeStateIsValid</h4>
<pre>public&nbsp;void&nbsp;assertNativeStateIsValid()
                              throws <a href="http://docs.oracle.com/javase/6/docs/api/java/sql/SQLException.html?is-external=true" title="class or interface in java.sql">SQLException</a></pre>
<div class="block">Throw an <code>SQLException</code> with a default message and SQLSTATE code
 of 55000 "object not in prerequisite state" if <code>nativeStateIsValid</code>
 returns <code>false</code>.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/6/docs/api/java/sql/SQLException.html?is-external=true" title="class or interface in java.sql">SQLException</a></code></dd></dl>
</li>
</ul>
<a name="toString()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>toString</h4>
<pre>public&nbsp;<a href="http://docs.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;toString()</pre>
<div class="block">Produce a string describing this state object in a way useful for
 debugging, with such information as the associated <code>ResourceOwner</code>
 and whether the state is fresh or stale.
<p>
 This method calls <a href="../../../../org/postgresql/pljava/internal/DualState.html#toString(java.lang.Object)"><code>toString(Object)</code></a> passing <code>this</code>.
 Subclasses are encouraged to override that method with versions that add
 subclass-specific details.</div>
<dl>
<dt><strong>Overrides:</strong></dt>
<dd><code><a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang">toString</a></code>&nbsp;in class&nbsp;<code><a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></code></dd>
<dt><span class="strong">Returns:</span></dt><dd>Description of this state object.</dd></dl>
</li>
</ul>
<a name="toString(java.lang.Object)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>toString</h4>
<pre>public&nbsp;<a href="http://docs.oracle.com/javase/6/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;toString(<a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>&nbsp;o)</pre>
<div class="block">Produce a string with such details of this object as might be useful for
 debugging, starting with an abbreviated form of the class name of the
 supplied object.
<p>
 Subclasses are encouraged to override this and then call it, via super,
 passing the object unchanged, and then append additional
 subclass-specific details to the result.
<p>
 Because the recursion ends here, this one actually does construct the
 abbreviated form of the class name of the object, and use it at the start
 of the returned string.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>o</code> - An object whose class name (abbreviated by stripping the package
 prefix) will be used at the start of the string. Passing <code>null</code> is
 the same as passing <code>this</code>.</dd>
<dt><span class="strong">Returns:</span></dt><dd>Description of this state object, prefixed with the abbreviated
 class name of the passed object.</dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/DualState.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../org/postgresql/pljava/internal/ByteBufferInputStream.html" title="class in org.postgresql.pljava.internal"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../org/postgresql/pljava/internal/DualState.Key.html" title="class in org.postgresql.pljava.internal"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?org/postgresql/pljava/internal/DualState.html" target="_top">Frames</a></li>
<li><a href="DualState.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested_class_summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2003&#x2013;2018 <a href="http://tada.se/eng/">Tada AB</a>. All rights reserved.</small></p>
</body>
</html>
